# Readme

_&copy; Simeon Lisovski, 28/08/219_

This is the github repo of the Swiss Ornithological **Migration Department** homepage.

## Initial setup

- make a github account [here](https://github.com/)
- ask Silke [silke.bauer@vogelwarte.ch](mailto:silke.bauer@vogelwarte.ch) or Simeon [simeon.lisovski@vogelwarte.ch](mailto:simeon.lisovski@vogelwarte.ch) to be added as a collaborator to the repo


## Using R Studio and Git (Version Control)

1. Install `blogdown` from your RStudio console. If you already have `devtools` installed like I did, you can just use the second line below:

```
if (!requireNamespace("devtools")) install.packages("devtools")
devtools::install_github("rstudio/blogdown")
```

2. Install Hugo using the `blogdown` package helper function:

```
blogdown::install_hugo()
# or
library(blogdown)
install_hugo()
```

3. To use version control with RStudio, you should first ensure that you have installed Git tools on your workstation. You should install it using the appropriate method for your platform:

* **Windows  & OS X**: http://git-scm.com/downloads
* **Debian/Ubuntu**: sudo apt-get install git-core
* **Fedora/RedHat**: sudo yum install git-core

FYI: An excellent resource for learning more about Git and how to use it is the Pro Git online book. Another good resource for learning about git is the Git Bootcamp provided by GitHub.

4. Best to create a folder (called `GitHub`) on your hard drive in which you will add/clone your GitHub repositories.

- go to your Command Prompt app (windows) and **run as administrator** (secondary mouse click -> run as administrator)
- navigate to your `GitHub` folder e.g.:

```
cd C:\Users\User\Documents\GitHub
```

- run this command in your terminal: 
```
git clone --recursive -j8 https://github.com/silkebauer/MigrationWebsite2019.git
```

- go into the now created folder (in your explorer) and open the `MigrationWebsite2019.RProj` file in RStudio.

## Folder organization 

```
├── content
│   ├── home
│   ├── members
│   └── publication
├── layouts
│   ├── partials
├── public
│   ├── categories
│   ├── css
│   ├── img
│   ├── js
│   ├── members
│   ├── publication
│   ├── publication_types
│   └── tags
├── resources
│   ├── _gen
├── static
│   ├── img
└── themes
    └── academic
```

- `content`: contains markdown files used to render the page 
	+ `home`: all widgets displayed on the first page 
	+ `member`: individual markdown file for each lab member 
	+ `publication`: individual file for each publication
		* these files are generated by the cic parser, and can subsequently be edited (to be implemented)

- `static`: contains all the files (papers, images, datasets, ...) in several subfolders


## Update the hompage 

If you have any trouble getting things to work, one way is to post an issue on the github repo or email Simeon [simeon.lisovski@vogelwarte.ch](mailto:simeon.lisovski@vogelwarte.ch). 

Once you have `git` installed on your computer you should see a new panel called `Git`. In this panes, you will see changes you make in any files and you will be able to `Commit` changes and `Push` them to the repository. The latter will automatically update the homepage.

**First** alwys `Pull` the most recent version from the github repository by either running (simply press `Pull`)

Once you changed something you can `Commit` the changes (select all or select the once you want to commit and **Important** provide a meaningfull comment that will allow other users to see what these changes are and undo them if nessesary). 

If you want to upload the changes to the `GitHub` repository press `Push`, provide your username and password and _done_!


### Add yourself to the homepage

- Add a folder `surname_name` to the members folder in content
- Add a picture;
  - Make sure that the image is not too large (ideally smaller than 1mb).
  - Ideally, it should be square. 
  - Name the picture `avatar.jpg`. 
- Add an `_index.md` file (copy paste from existing member).
- Adjust text in `_index.md` file.

You can built the homepage and check if your changes work and how the website would look like by either running:

```
logdown::serve_site()
```

or go to Addins <- Serve Site,

Do *not* knit but use `blogdown::serve_site`. 

This command will give you a temporary url (e.g. http://127.0.0.1:4321/) where you can view the updated version (better to use this link and paste it into a browser rather than using the RStudio Viewer panel.


### Add a publication 

#### Update the lab's bibtex file 

- The lab's bibtex file is located here: `static/bibtex/cic_papers.bib`. 
- Add the bibtex entry of your publication to the file. 
- Make sure to add an abstract to your entry. 

#### Parse the bibtex file to update the homepage

In your terminal, navigate to the root folder and run: 

```
python3 parse_bib_cic.py -i static/bibtex/cic_papers.bib
```

This will create a new markdown file in the `content/publication/` folder for each new publication that was added to the lab's bibdesk repository. The markdown file is named `bibentryid.md`, for example `gerstenberg2016csm.md`. 

The parser also puts individual `.bib` files for each publication into `static/files/citations/`. 

#### Add a pdf of your paper 

Add a pdf of your paper to `static/papers/` using the same name as the markdown file above (e.g. `gerstenberg2016csm.pdf`).

#### Tweak the publication page 

Navigate to `content/publication/` to open the publication. Adapt the links: 

```
# Links (optional).
url_pdf = "papers/gerstenberg2016csm.pdf"
url_preprint = ""
url_code = ""
url_dataset = ""
url_project = ""
url_slides = "https://link_to_slides.pdf"
url_video = ""
url_poster = ""
url_source = ""
```

You can also generate new links by changing `url_custom = []` to 

```
url_custom = [
{name = "link_name1", url = "url1"},
{name = "link_name2", url = "url2"}
]
```

You can also add an image to go with the paper by putting it into `static/img/publications/` and linking to by adapting the `image =""` parameter (e.g. `image ="publications/gerstenberg2016csm.png"`).

## Develop the page 

Here is a list of the key files to play around with: 

- `config.toml`: Configuration file 
	+ navigation bar 
	+ what's displayed on home page 
- `homepage/layouts`: 
	+ contains subfolders with files to adapt the different widgets and pages
- `/static/css/custom.css`:
	+ css file to adapt any of the stylings 

## Some useful things to know

### Commenting 

- html: `<-- comment -->` 
- markdown: `# comment`
- css: `/* comment */`
- hugo: `// comment`

### Bibtex 

- For the abstracts in the bibtex files, make sure to typeset `"` as `''` (i.e. with two separate quote marks). Otherwise, the metadata in the corresponding `publication.md` file is incorrect. 

## Tutorial links 

- https://georgecushen.com/create-your-website-with-hugo/

## To do list 

- add News, Projects and automated publication formatting
